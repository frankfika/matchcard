## 目标
- 修复认证、导航与编辑体验问题，减少控制台噪声，确保核心流程（注册→登录→Dashboard→编辑→分享→申请→审批）稳定。

## Bug 审核与定位
- 认证端点：排查 `/api/auth/session` 返回 HTML/500 的原因；统一 Node 运行时与动态渲染；校验 `AUTH_SECRET`/`AUTH_URL`。
- RSC 预取取消：识别 `/_rsc` 的请求取消是否源于预取与 HMR；按需关闭关键链接的 `prefetch`。
- 参数类型：统一 `app/p/[code]/page.tsx` 的 `params` 类型以适配 Next 生成类型。
- 滚动容器：确认 Dashboard 布局的 `min-h-0` 及编辑面板滚动是否生效；移除阻断滚动的事件样式。

## 认证稳定化
- 路由：`app/api/auth/[...nextauth]/route.ts` 明确导出 `GET/POST`，设置 `runtime='nodejs'`、`dynamic='force-dynamic'`。
- 配置：`lib/auth.ts` 恢复安全的 Credentials 登录（使用 `bcrypt`）与 `PrismaAdapter`；在开发环境保留降级兜底以避免构建期依赖异常。
- 环境：校验 `.env.local` 的 `AUTH_SECRET` 强随机值与 `AUTH_URL=http://localhost:3002` 一致性。

## 导航与噪声优化
- 关闭非必要的链接预取（Dashboard 导航 Tab 保留可跳转但 `prefetch=false`）。
- `SessionProvider` 降低自动 refetch 频率（关闭焦点/离线时轮询）。
- Logo：保持为纯展示，避免误触发导航与预取。

## 编辑交互与可用性
- 顶部锁定提示条：在未解锁时常驻提示如何解锁。
- 点击提醒：未解锁时点击输入控件弹出轻提示。
- 不可编辑状态样式：为 `disabled` 的控件添加 `cursor-not-allowed`，提升可感知性。
- 保证滚动：父容器 `min-h-0`，编辑区域 `flex-1 overflow-y-auto`，不再使用 `pointer-events-none` 阻断滚动。

## 提交/审批流程
- 申请提交：`ApplyForm` 正确收集并提交；错误提示清晰。
- 收件箱：`InboxList` 状态切换与微信号遮罩显示逻辑正确；复制操作可用。
- 发件箱：`SentList` 状态徽章正常显示。

## 测试与验证
- 端到端检查：
  - 注册新用户 → 登录 → Dashboard → 编辑与保存 → 生成分享链接 → 访问 `/p/{code}` → 提交申请 → 被申请者审批。
- 接口验证：
  - `/api/auth/session` 返回 JSON 200；`/p/{code}` 返回表单；申请增删改查均成功。
- 类型与规范：`tsc -noEmit`/`lint` 通过；修复 `replyMessage` 的 `null`/`undefined` 映射一致性。

## 交付
- 代码改动涵盖路径：`lib/auth.ts`、`app/api/auth/[...nextauth]/route.ts`、`app/layout.tsx`、`app/dashboard/layout.tsx`、`components/dashboard/*`、`app/p/[code]/page.tsx`、`app/(auth)/login/page.tsx`。
- 提供测试账号与种子脚本（仅用于开发验证），生产关闭开发兜底逻辑并启用安全校验。

请确认以上计划，我将按步骤实施、验证，并回传可用链接与测试结果。